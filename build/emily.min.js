/*
 emily.js <VERSION> http://flams.github.com/emily

 The MIT License (MIT)

 Copyright (c) 2012-2014 Olivier Scherrer <pode.fr@gmail.com>
*/
require=function e$$0(k,i,a){function b(d,h){if(!i[d]){if(!k[d]){var g=typeof require=="function"&&require;if(!h&&g)return g(d,true);if(c)return c(d,true);throw Error("Cannot find module '"+d+"'");}g=i[d]={exports:{}};k[d][0].call(g.exports,function(f){var a=k[d][1][f];return b(a?a:f)},g,g.exports,e$$0,k,i,a)}return i[d].exports}for(var c=typeof require=="function"&&require,d=0;d<a.length;d++)b(a[d]);return b}({1:[function(j,k){var i=j("./Tools");k.exports=function(){var a={};this.watch=function(b,
c,d){if(typeof c=="function"){var e=a[b]=a[b]||[],c=[c,d];e.push(c);return[b,e.indexOf(c)]}else return false};this.once=function(a,c,d){var e=this.watch(a,function(){c.apply(d,arguments);this.unwatch(e)},this);return e};this.unwatch=function(b){var c=b[0],b=b[1];return a[c]&&a[c][b]?(delete a[c][b],a[c].some(function(a){return!!a})||delete a[c],true):false};this.notify=function(b){var c=a[b],d=i.toArray(arguments).slice(1);return c?(i.loop(c,function(a){try{a&&a[0].apply(a[1]||null,d)}catch(c){}}),
true):false};this.hasObserver=function(b){return!(!b||!a[b[0]]||!a[b[0]][b[1]])};this.hasTopic=function(b){return!!a[b]};this.unwatchAll=function(b){a[b]?delete a[b]:a={};return true}}},{"./Tools":6}],2:[function(j,k){var i=j("./Observable"),a=j("./StateMachine");k.exports=function c(){var d=null,e=null,h=new i,g=new a("Pending",{Pending:[["fulfill",function(f){d=f;h.notify("fulfill",f)},"Fulfilled"],["reject",function(f){e=f;h.notify("reject",f)},"Rejected"],["toFulfill",function(f){h.watch("fulfill",
f)}],["toReject",function(f){h.watch("reject",f)}]],Fulfilled:[["toFulfill",function(f){f(d)}]],Rejected:[["toReject",function(f){f(e)}]]});this.fulfill=function(f){setTimeout(function(){g.event("fulfill",f)},0);return this};this.reject=function(f){setTimeout(function(){g.event("reject",f)},0);return this};this.then=function(f,a,h,j){var i=new c;f instanceof Function?a instanceof Function?g.event("toFulfill",this.makeResolver(i,f)):g.event("toFulfill",this.makeResolver(i,f,a)):g.event("toFulfill",
this.makeResolver(i,function(){i.fulfill(d)}));a instanceof Function&&g.event("toReject",this.makeResolver(i,a,h));h instanceof Function&&g.event("toReject",this.makeResolver(i,h,j));!(a instanceof Function)&&!(h instanceof Function)&&g.event("toReject",this.makeResolver(i,function(){i.reject(e)}));return i};this.cast=function(f){return f instanceof c||typeof f=="object"||typeof f=="function"?(f.then(this.fulfill.bind(this),this.reject.bind(this)),true):false};this.makeResolver=function(f,a,c){return function(d){var e;
try{e=a.call(c,d);if(e===f)throw new TypeError("Promise A+ 2.3.1: If `promise` and `x` refer to the same object, reject `promise` with a `TypeError' as the reason.");f.cast(e)||f.fulfill(e)}catch(h){f.reject(h)}}};this.getReason=function(){return e};this.getValue=function(){return d};this.getObservable=function(){return h};this.getStateMachine=function(){return g};this.getStates=function(){return _states}}},{"./Observable":1,"./StateMachine":4}],3:[function(j,k){var i=j("./Observable"),a=j("./Store"),
b=j("./Tools");k.exports=function(){var c=new i,d=new i,e=new a([]),h=-1,g=10;this.getRoutesObservable=function(){return c};this.getEventsObservable=function(){return d};this.setMaxHistory=function(f){return f>=0?(g=f,true):false};this.getMaxHistory=function(){return g};this.set=function(){return c.watch.apply(c,arguments)};this.unset=function(f){return c.unwatch(f)};this.navigate=function(f,a){return this.load.apply(this,arguments)?(e.proxy("splice",h+1,e.count()),e.proxy("push",b.toArray(arguments)),
this.ensureMaxHistory(e),h=e.count()-1,true):false};this.ensureMaxHistory=function(f){var a=f.count(),c=this.getMaxHistory();a-=c;a>0&&f.proxy("splice",0,a)};this.load=function(){var a=b.toArray(arguments);return c.notify.apply(c,a)?(a.unshift("route"),d.notify.apply(d,a),true):false};this.watch=function(a,c){return d.watch("route",a,c)};this.unwatch=function(a){return d.unwatch(a)};this.getHistoryStore=function(){return e};this.getHistoryCount=function(){return e.count()};this.clearHistory=function(){e.reset([])};
this.go=function(a){var c=e.get(h+a);return c?(h+=a,this.load.apply(this,c),true):false};this.back=function(){return this.go(-1)};this.forward=function(){return this.go(1)}}},{"./Observable":1,"./Store":5,"./Tools":6}],4:[function(j,k){function i(){var b={};this.add=function(a,d,e,h){var g=[];if(b[a])return false;return typeof a=="string"&&typeof d=="function"?(g[0]=d,typeof e=="object"&&(g[1]=e),typeof e=="string"&&(g[2]=e),typeof h=="string"&&(g[2]=h),b[a]=g,true):false};this.has=function(a){return!!b[a]};
this.get=function(a){return b[a]||false};this.event=function(c){var d=b[c];return d?(d[0].apply(d[1],a.toArray(arguments).slice(1)),d[2]):false}}var a=j("./Tools");k.exports=function(b,c){var d={},e="";this.init=function(a){return d[a]?(e=a,true):false};this.add=function(a){return d[a]?d[a]:d[a]=new i};this.get=function(a){return d[a]};this.getCurrent=function(){return e};this.has=function(a){return d.hasOwnProperty(a)};this.advance=function(a){return this.has(a)?(e=a,true):false};this.event=function(c){var b;
b=d[e].event.apply(d[e].event,a.toArray(arguments));return b===false?false:(b&&(d[e].event("exit"),e=b,d[e].event("entry")),true)};a.loop(c,function(a,c){var f=this.add(c);a.forEach(function(a){f.add.apply(null,a)})},this);this.init(b)}},{"./Tools":6}],5:[function(j,k){var i=j("./Observable"),a=j("./Tools");k.exports=function(b){var c=a.clone(b)||{},d=new i,e=new i,h=[],g=function(f){var b=a.objectsDiffs(f,c);["updated","deleted","added"].forEach(function(a){b[a].forEach(function(f){d.notify(a,f,
c[f]);e.notify(f,c[f],a)})})};this.count=this.getNbItems=function(){return c instanceof Array?c.length:a.count(c)};this.get=function(a){return c[a]};this.has=function(a){return c.hasOwnProperty(a)};this.set=function(a,b){var g,h;return typeof a!="undefined"?(g=this.has(a),h=this.get(a),c[a]=b,g=g?"updated":"added",d.notify(g,a,c[a],h),e.notify(a,c[a],g,h),true):false};this.update=function(f,c,b){var g;return this.has(f)?(g=this.get(f),a.setNestedProperty(g,c,b),d.notify("updated",c,b),e.notify(f,
g,"updated"),true):false};this.del=function(a){return this.has(a)?(this.alter("splice",a,1)||(delete c[a],d.notify("deleted",a),e.notify(a,c[a],"deleted")),true):false};this.delAll=function(f){return f instanceof Array?(f.sort(a.compareNumbers).reverse().forEach(this.del,this),true):false};this.alter=function(f){var b,e;return c[f]?(e=a.clone(c),b=this.proxy.apply(this,arguments),g(e),d.notify("altered",c,e),b):false};this.proxy=function(a){return c[a]?c[a].apply(c,Array.prototype.slice.call(arguments,
1)):false};this.watch=function(a,b,c){return d.watch(a,b,c)};this.unwatch=function(a){return d.unwatch(a)};this.getStoreObservable=function(){return d};this.watchValue=function(a,b,c){return e.watch(a,b,c)};this.unwatchValue=function(a){return e.unwatch(a)};this.getValueObservable=function(){return e};this.loop=function(b,d){a.loop(c,b,d)};this.reset=function(b){if(b instanceof Object){var e=a.clone(c);c=a.clone(b)||{};g(e);d.notify("resetted",c,e);return true}else return false};this.compute=function(b,
c,d,e){return typeof b=="string"&&typeof c=="object"&&typeof d=="function"&&!this.isCompute(b)?(h[b]=[],a.loop(c,function(a){h[b].push(this.watchValue(a,function(){this.set(b,d.call(e))},this))},this),this.set(b,d.call(e)),true):false};this.removeCompute=function(b){return this.isCompute(b)?(a.loop(h[b],function(a){this.unwatchValue(a)},this),this.del(b),true):false};this.isCompute=function(a){return!!h[a]};this.toJSON=function(){return JSON.stringify(c)};this.dump=function(){return c}}},{"./Observable":1,
"./Tools":6}],6:[function(j,k){function i(a,b,c){var d,e;if(b)return b.forEach(function(b,g){var f=c(b,a);if(f>=0&&(typeof e=="undefined"||f<e))e=f,d=g}),d}k.exports={getGlobal:function(){return Function("return this")()},mixin:function(a,b,c){this.loop(a,function(d,e){if(!b[e]||!c)b[e]=a[e]});return b},count:function(a){var b=0;this.loop(a,function(){b++});return b},compareObjects:function(a,b){return Object.getOwnPropertyNames(a).sort().join("")==Object.getOwnPropertyNames(b).sort().join("")},compareNumbers:function(a,
b){return a>b?1:a<b?-1:0},toArray:function(a){return[].slice.call(a)},loop:function(a,b,c){var d;if(a instanceof Object&&b instanceof Function){if(a instanceof Array)for(d=0;d<a.length;d++)b.call(c,a[d],d,a);else for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a);return true}else return false},objectsDiffs:function(a,b){if(a instanceof Object&&b instanceof Object){var c=[],d=[],e=[],h=[];this.loop(b,function(b,e){typeof a[e]=="undefined"?h.push(e):b!==a[e]?d.push(e):b===a[e]&&c.push(e)});this.loop(a,
function(a,c){typeof b[c]=="undefined"&&e.push(c)});return{updated:d,unchanged:c,added:h,deleted:e}}else return false},jsonify:function(a){return a instanceof Object?JSON.parse(JSON.stringify(a)):false},clone:function(a){return a instanceof Array?a.slice(0):typeof a=="object"&&a!==null&&!(a instanceof RegExp)?this.mixin(a,{}):false},getNestedProperty:function(a,b){return a&&a instanceof Object?typeof b=="string"&&b!==""?b.split(".").reduce(function(a,b){return a&&a[b]},a):typeof b=="number"?a[b]:
a:a},setNestedProperty:function(a,b,c){if(a&&a instanceof Object)if(typeof b=="string"&&b!==""){var d=b.split(".");return d.reduce(function(a,b,g){a[b]=a[b]||{};d.length==g+1&&(a[b]=c);return a[b]},a)}else return typeof b=="number"?(a[b]=c,a[b]):a;else return a},closest:function(a,b){return i(a,b,function(a,b){return Math.abs(a-b)})},closestGreater:function(a,b){return i(a,b,function(a,b){return a-b})},closestLower:function(a,b){return i(a,b,function(a,b){return b-a})}}},{}],7:[function(j,k){k.exports=
function(i){var a=null;this.setReqHandlers=function(b){return b instanceof Object?(a=b,true):false};this.getReqHandlers=function(){return a};this.request=function(b,c,d,e){return a.has(b)&&typeof c!="undefined"?(a.get(b)(c,function(){d&&d.apply(e,arguments)}),true):false};this.listen=function(b,c,d,e){if(a.has(b)&&typeof c!="undefined"&&typeof d=="function"){var h=function(){d.apply(e,arguments)},g;g=a.get(b)(c,h,h);return function(){typeof g=="function"?g():typeof g=="object"&&typeof g.func=="function"&&
g.func.call(g.scope)}}else return false};this.setReqHandlers(i)}},{}],p9p59I:[function(j,k){k.exports={Observable:j("./Observable"),Promise:j("./Promise"),Router:j("./Router"),StateMachine:j("./StateMachine"),Store:j("./Store"),Tools:j("./Tools"),Transport:j("./Transport")}},{"./Observable":1,"./Promise":2,"./Router":3,"./StateMachine":4,"./Store":5,"./Tools":6,"./Transport":7}],emily:[function(j,k){k.exports=j("p9p59I")},{}]},{},[]);
