define("Observable",function(){function f(){var a={};this.watch=function(b,d,c){if(typeof b=="string"&&typeof d=="function"){var g=a[b]=a[b]||[];observer=[d,c];g.push(observer);return[b,g.indexOf(observer)]}else return false};this.unwatch=function(b){var d=b[0],b=b[1];return a[d]&&a[d][b]?(a[d][b]=null,true):false};this.notify=function(b,d){var c=a[b],g;if(c){for(g=c.length;g--;)c[g]&&c[g][0].call(c[g][1]||null,d);return true}else return false};this.hasObserver=function(b){return!(!b||!a[b[0]]||!a[b[0]][b[1]])}}
return{create:function(){return new f}}});
define("StateMachine",function(){function f(){var b={},d="";this.init=function(c){return b[c]?(d=c,true):false};this.add=function(c){return b[c]?false:b[c]=new a};this.get=function(c){return b[c]};this.getCurrent=function(){return d};this.event=function(c,a){var e=b[d].event(c,a);return e===false?false:(d=e||d,true)}}function a(){var b={};this.add=function(d,c,a,e){var h=[];if(b[d])return false;return typeof d=="string"&&typeof c=="function"?(h[0]=c,typeof a=="object"&&(h[1]=a),typeof a=="string"&&
(h[2]=a),typeof e=="string"&&(h[2]=e),b[d]=h,true):false};this.has=function(d){return!!b[d]};this.event=function c(c,a){var e=b[c];return e?(e[0].call(e[1],a),e[2]):false}}return{create:function(b,d){var c=new f,a,e;for(a in d)d.hasOwnProperty(a)&&(e=c.add(a),d[a].forEach(function(a){e.add.apply(null,a)}));c.init(b);return c}}});
define("TinyStore",["Observable","Tools"],function(f,a){function b(d){var c={},b=a,e=f.create();b.mixin(d,c);this.getNbItems=function(){return b.count(c)};this.get=function(a){return c[a]};this.has=function(a){return c.hasOwnProperty(a)};this.set=function(a,b){return typeof a=="string"?(c[a]=b,e.notify(a,b),true):false};this.del=function(a){return this.has(a)?(delete c[a],e.notify(a,c[a]),true):false};this.watch=function(a,b,c){return e.watch(a,b,c)};this.unwatch=function(a){return e.unwatch(a)}}
return{create:function(a){return new b(a)}}});define("Tools",function(){return{getGlobal:function(){return function(){return this}.call(null)},mixin:function(f,a,b){for(var d in f)if(f.hasOwnProperty(d)&&(!a[d]||!b))a[d]=f[d]},count:function(f){var a=0,b;for(b in f)f.hasOwnProperty(b)&&a++;return a},compareObjects:function(f,a){return Object.getOwnPropertyNames(f).sort().join("")==Object.getOwnPropertyNames(a).sort().join("")},toArray:function(f){return Array.prototype.slice.call(f)}}});
define("Transport",function(){function f(){var a,b=io;this.connect=function(d){a=b.connect(d);return!!a};this.getSocket=function(){return a};this.on=function(b,c){a.on(b,c)};this.once=function(b,c){a.once(b,c)};this.emit=function(b,c){a.emit(b,c)};this.request=function(b,c,f){var e=+new Date+Math.floor(Math.random()*1E6);console.log(e);a.once(e,f);c.__eventId__=e;a.emit(b,c)}}return{create:function(a){var b=new f(a);b.connect(a);return b}}});
